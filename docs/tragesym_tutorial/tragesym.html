<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>gschem symbol creation, the quick and easy tragesym way</title>
</head>

<body>

<h2>Creating gschem symbols quickly and easily using tragesym and a spreadsheet
programm</h2>
Creating symbols for schematic capture can be very time consuming,
error prone, and an all around pain. 
Luckily, gschem uses an open, text based file format that is very easy to use
with scripting. 
This short tutorial describes how to use the tragesym script, to create
symbols very quickly (probably more quickly than with any commercial
package).

<h3>Required steps:</h3>
    <ul>
      <li>Step1: Open a tragesym template file</li>
      <li>Step2: Download the part data sheet and find the pin list</li>
      <li>Step3: Copy the pin list into an editor and prepare it</li>
      <li>Step4: Insert all missing data into the spreadsheet</li>
      <li>Step5: Export the spreadsheet into a tab seperated text file</li>
      <li>Step6: execute tragesym and create the symbol</li>
      <li>Step7: check the result with gschem and do some artwork</li>
    </ul>


<h3>Step 1: Open a tragesym template file</h3>
tragesym comes with two template files. One is ASCII text, the second is a <a
href="http://www.openoffice.org">OpenOffice</a> spreadsheet file.
You can obtain them from the gEDA utility package: 
utils/examples/tragesym/template.src and utils/examples/tragesym/template.ods
<br>
If you prefer a different spreadsheet program, like gnumeric or kspread, just
create your own template out of the textual template file.
The only difference between the textual template and the spreadsheet template is
the syntax of the key value pairs in the [options] and [geda_attr] sections. 
The textfile splits them with an equal sign (key=value), the spreadsheet has the
value in the second column (which becomes a tab after beeing exported).


<h3>Step 2: Download the part data sheet and find the pin list</h3>
For this example, we will create a symbol from the Philips
Semiconductor PCA9555 16-bit IIC IO port. The description of product and
datasheet is available at Philips:
<a
HREF="http://www-us.semiconductors.philips.com/cgi-bin/pldb/pip/pca9555.html">
http://www-us.semiconductors.philips.com/cgi-bin/pldb/pip/pca9555.html</a>.
Download the datasheet and open it with a pdf viewer that allows copying text
out of the pdf file, such as xpdf. Flip through the pages until you find the
pinout for
the device: <p>

<img src="xpdf_pinconfiguration.png" border="0" hspace="10" vspace="10">
<img src="acroread_selectiontable.png" border="0" hspace="10" vspace="10"> 

<h3>Step3: Copy the pin list into an editor and prepare it</h3>

Inside the datasheet the pin list may only be in the drawing of the pin
configuration.
If there's a nice table, like in the second picture, use this one.
Select the pin list and copy it into a text editor. 
This intermediate step is required as your spreadsheet programm may need a
special field seperator, like comma or tab. You may have to remove duplicate
seperators or replace it with tabs. <p>
<b>Note:</b>
The selection behaviour of xpdf is different from the acroread viewer. 
The xpdf viewer seems to give you a copy that looks more like the graphical
representation, while the acroread viewer produces an output that is more "file
order" oriented. 
If you have to create a lot of symbols, try both and compare the results. <p>

<img src="xemacs_rawselection.png" border="0" hspace="10" vspace="10">
<img src="xemacs_modifiedselection.png" border="0" hspace="10" vspace="10">
<img src="ooo_selection.png" border="0" hspace="10" vspace="10"> <p>

The pictures above illustrate the steps:
    <ul>
      <li>insert the selection from your pdf viewer into a text editor</li>
      <li>modify the pinlist to make your spreadsheet programm happy
	<ul> 
	  <li>cut out pinlist 24 to 13 with a rectangular selection</li>
	  <li>insert the rectangular selection below the pins 1 to 12</li>
	  <li>sort the lines (xemacs can do that ;-))</li>
	  <li>remove or repair the lines with the numbers 2,3,... They are not
in the same line. You can easily recreate the pin numbers later</li>
	  <li>replace the spaces with tabs (not really need when using
OpenOffice)</li>
	</ul>
      </li>
      <li>copy the modified data into the spreadsheet template somewhere beside
</li>
    </ul>

<h3>Step4: Insert all missing data into the spreadsheet</h3>
Now, move the labels into the label column and the pin numbers into the pin
number column.
You can use the autofill feature of your spreadsheet programm to create the pin
numbers, too. <p>
<img src="ooo_rearanged.png" border="0" hspace="10" vspace="10"> <p>
Set the type, style and position column to the most common value. You can use
the autofill feature again.<p>

Now you want to change some fo the values. Take a look at the pin description
table in the datasheet: <p>
<img src="xpdf_pindescription.png" border="0" hspace="10" vspace="10"> <p>

Regarding to that table we change the following things (see result below):
    <ul>
      <li>Pin 1 is an output, we like to have a negation bubble and a negation
overbar</li>
      <li>A1 to A3 are inputs, we change the type and move them to the left
side</li>
      <li>set the SCL type to inpult and move SCL and SDA to the left side, too
</li>
      <li>change the type of the power pins VSS and VDD and add net names. We
use the more usual GND and Vcc.</li>
    </ul>
<b>Note:</b> If one of your pin labels has a backslash "\" inside, you have to
replace it with it's escape sequence "\\". <p>
<img src="ooo_changedpins.png" border="0" hspace="10" vspace="10"> <p>

Before going on set the attributes and the options to appropriate values.<p>
<img src="ooo_attributes.png" border="0" hspace="10" vspace="10"> 


<h3>Step5: Export the spreadsheet into a tab seperated text file</h3>
You can either use the export function of your spreadsheet programm to create a
tab seperated textfile or just select the table and copy the content into your
text editor and save the file.


<h3>Step6: execute tragesym and create the symbol</h3>
Just use a shell and execute tragesym:
<pre>
werner@werner-amd64:~/Desktop/tragesym_tutorial> tragesym pca555.src pca555.sch
</pre>
If tragesym says that there's an error, just make some changes in the
spreadsheet and export the file again, or just edit the exported file.


<h3>Step7: check the result with gschem and do some artwork</h3>
Now open the generated symbol with gschem and check the result
<pre>
werner@werner-amd64:~/Desktop/tragesym_tutorial> gschem pca555.sch &gt;
</pre>
Enabling the hidden text ("en", Edit-&gt;Show/Hide Inv Text), you can see the
whole generated symbol.
It's not really necessary to change anything, but it might improve the look of
the symbol if you rearange the pins a little bit.<p>
<img src="gschem_showhidden.png" border="0" hspace="10" vspace="10">
<img src="gschem_finished.png" border="0" hspace="10" vspace="10"> <p>

Now we have a complete symbol. You can copy the symbol to your local symbol
library e.g. /usr/local/share/gEDA/sym/local/ and use it.

<h3>Conclusion</h3>
This was a simple example with a small pincount, but this method really
pays off when you have high pin counts (ie, bga-272, tfqp-100, etc).

<h3>Credits</h3>
Many thanks to <a HREF="mailto:Russ.Dill@asu.edu">&lt;Russ.Dill@asu.edu&gt;</a>,
who wrote the first version of this tutorial.

<h3>Questions/Comments?</h3>
If you have any comments or questions please send me a mail <a
HREF="mailto:werner.ho@gmx.de">&lt;werner.ho@gmx.de&gt;</a>. You can use one of
the gEDA mailing lists too.

</body>
</html>



