dnl Process this file with autoconf to produce a configure script.
AC_INIT(74/7400-1.sym)

dnl Initialize automake stuff
PACKAGE=gEDA

# new way of doing version
VERSION=19990829

echo Configuring symbols version $VERSION

dnl Change default location for rc files
AC_ARG_WITH(rcdir, [  --with-rcdir=path       Change where the system-*rc files are installed], [opt_rcdir=$withval])

dnl Initialize automake stuff
dnl AM_INIT_AUTOMAKE($PACKAGE, $GEDA_VER_MAJOR.$GEDA_VER_MINOR.$GEDA_VER_MICRO, no-define)
AM_INIT_AUTOMAKE($PACKAGE, $VERSION, no-define)

dnl Create a configuration header
dnl AM_CONFIG_HEADER(config.h)

dnl Build time sanity check...
dnl AM_SANITY_CHECK

dnl Initialize libtool libtool isn't needed for gschem
dnl AM_PROG_LIBTOOL

dnl Initialize maintainer mode
AM_MAINTAINER_MODE

dnl Checks for programs.
dnl AC_PROG_CC
dnl AC_PROG_LEX
dnl AC_DECL_YYTEXT
dnl AC_PROG_MAKE_SET

# Defs for libary symbol files
#
# Expand the prefix variable
if eval "test x$prefix = xNONE"; then
 dprefix=$ac_default_prefix
else
 dprefix=$prefix
fi

# Old way of installing data into a version dependant dir
#gedatopdir=$dprefix/share/$PACKAGE-$VERSION

gedatopdir=$dprefix/share/$PACKAGE
expandgedadatadir=`echo $gedatopdir`

# new way without version
gedadatadir=$datadir/$PACKAGE

AC_DEFINE_UNQUOTED(GEDADATADIR, "$gedatopdir")
AC_DEFINE_UNQUOTED(VERSION, "$VERSION")



# Do individual library files


data4000=`ls -1 4000 | grep -v Makefile | grep -v CVS`
data4000=`echo $data4000`

datalocal=`ls -1 local | grep -v Makefile | grep -v CVS`
datalocal=`echo $datalocal`

dataio=`ls -1 io | grep -v Makefile | grep -v CVS`
dataio=`echo $dataio`

dataanalog=`ls -1 analog | grep -v Makefile | grep -v CVS`
dataanalog=`echo $dataanalog`

datamaxim=`ls -1 maxim | grep -v Makefile | grep -v CVS`
datamaxim=`echo $datamaxim`

dataverilog=`ls -1 verilog | grep -v Makefile | grep -v CVS`
dataverilog=`echo $dataverilog`

dataspice=`ls -1 spice | grep -v Makefile | grep -v CVS`
dataspice=`echo $dataspice`

dataconnector=`ls -1 connector | grep -v Makefile | grep -v CVS`
dataconnector=`echo $dataconnector`

dataaltera=`ls -1 altera | grep -v Makefile | grep -v CVS`
dataaltera=`echo $dataaltera`

datalinear=`ls -1 linear | grep -v Makefile | grep -v CVS`
datalinear=`echo $datalinear`

dataswitch=`ls -1 switch | grep -v Makefile | grep -v CVS`
dataswitch=`echo $dataswitch`

datatitleblock=`ls -1 titleblock | grep -v Makefile | grep -v CVS`
datatitleblock=`echo $datatitleblock`

datatube=`ls -1 tube | grep -v Makefile | grep -v CVS`
datatube=`echo $datatube`

dataradio=`ls -1 radio | grep -v Makefile | grep -v CVS`
dataradio=`echo $dataradio`

datamicro=`ls -1 micro | grep -v Makefile | grep -v CVS`
datamicro=`echo $datamicro`

datamemory=`ls -1 memory | grep -v Makefile | grep -v CVS`
datamemory=`echo $datamemory`

datamisc=`ls -1 misc | grep -v Makefile | grep -v CVS`
datamisc=`echo $datamisc`

data74=`ls -1 74 | grep -v Makefile | grep -v CVS`
data74=`echo $data74`

datafoot=`ls -1 foot | grep -v Makefile | grep -v CVS`
datafoot=`echo $datafoot`

dataIEC417=`ls -1 IEC417 | grep -v Makefile | grep -v CVS`
dataIEC417=`echo $dataIEC417`

datafont=`ls -1 font | grep -v Makefile | grep -v CVS`
datafont=`echo $datafont`

dataidt=`ls -1 idt | grep -v Makefile | grep -v CVS`
dataidt=`echo $dataidt`

symdir=$gedatopdir/sym
sourcedir=$gedatopdir/source

HOME=`echo $HOME`

# old way of installing data into a version dependant directory
#gedadatadir=$datadir/$PACKAGE-$VERSION
# new way without version
gedadatadir=$datadir/$PACKAGE

if eval "test x$opt_rcdir = x"; then

	if eval "test x$prefix = xNONE"; then
		rclocation=$expandgedadatadir
	else
		rclocation=`eval echo $gedadatadir`
	fi

	# this needs to be expanded (NO ${prefix}) since it's used in the code
	AC_DEFINE_UNQUOTED(GEDARCDIR, "$rclocation")
	expandgedarcdir=$rclocation

	# this is used in the makefiles so it can have a ${prefix} in it
	gedarcdir=$gedadatadir
else

	# path WAS specified with --with-rcdir
	gedarcdir=$opt_rcdir
	expandgedarcdir=$opt_rcdir
	AC_DEFINE_UNQUOTED(GEDARCDIR, "$opt_rcdir")

fi


AC_DEFINE_UNQUOTED(GEDADATADIR, "$gedatopdir")
AC_DEFINE_UNQUOTED(VERSION, "$GEDA_VERSION")

AC_SUBST(gedadatadir)
AC_SUBST(gedarcdir)
AC_SUBST(expandgedadatadir)

AC_SUBST(datalocal)
AC_SUBST(dataanalog)
AC_SUBST(datamaxim)
AC_SUBST(dataverilog)
AC_SUBST(dataspice)
AC_SUBST(dataconnector)
AC_SUBST(dataaltera)
AC_SUBST(datalinear)
AC_SUBST(dataio)
AC_SUBST(dataswitch)
AC_SUBST(datatitleblock)
AC_SUBST(data4000)
AC_SUBST(datatube)
AC_SUBST(dataradio)
AC_SUBST(datamemory)
AC_SUBST(datamicro)
AC_SUBST(datamisc)
AC_SUBST(data74)
AC_SUBST(datafoot)
AC_SUBST(dataIEC417)
AC_SUBST(datafont)
AC_SUBST(dataidt)

AC_SUBST(symdir)
AC_SUBST(sourcedir)

AC_SUBST(HOME)
AC_SUBST(VERSION)

AC_OUTPUT([ 
        Makefile 
	4000/Makefile
	74/Makefile 
	IEC417/Makefile 
	altera/Makefile 
	analog/Makefile 
	connector/Makefile 
	font/Makefile 
	foot/Makefile 
	idt/Makefile 
	io/Makefile 
	linear/Makefile 
	local/Makefile
        maxim/Makefile 
	memory/Makefile 
	micro/Makefile 
	misc/Makefile 
	radio/Makefile 
	switch/Makefile 
	titleblock/Makefile 
	tube/Makefile 
	verilog/Makefile
	spice/Makefile
	system-commonrc
        gesym-config ], [chmod +x gesym-config]) 

