dnl Process this file with autoconf to produce a configure script.


dnl Some of our own macros
AC_DEFUN(GEDA_DECLARE_SYMLIB,
 [
	data$1=`ls -1 $srcdir/$1 | grep -v Makefile | grep -v CVS`
	data$1=`echo $data$1`
 ])


dnl Start of configure actions..
AC_INIT(74/7400-1.sym)

dnl Initialize automake stuff
PACKAGE=gEDA

# new way of doing version
VERSION=20001217

echo Configuring symbols version $VERSION

dnl Change default location for rc files
AC_ARG_WITH(rcdir, [  --with-rcdir=path       Change where the system-*rc files are installed], [opt_rcdir=$withval])

dnl Initialize automake stuff
dnl AM_INIT_AUTOMAKE($PACKAGE, $GEDA_VER_MAJOR.$GEDA_VER_MINOR.$GEDA_VER_MICRO, no-define)
AM_INIT_AUTOMAKE($PACKAGE, $VERSION, no-define)

dnl Create a configuration header
dnl AM_CONFIG_HEADER(config.h)

dnl Build time sanity check...
dnl AM_SANITY_CHECK

dnl Initialize libtool libtool isn't needed for gschem
dnl AM_PROG_LIBTOOL

dnl Initialize maintainer mode
AM_MAINTAINER_MODE

dnl Checks for programs.
dnl AC_PROG_CC
dnl AC_PROG_LEX
dnl AC_DECL_YYTEXT
dnl AC_PROG_MAKE_SET

# Defs for libary symbol files
#
# Expand the prefix variable
if eval "test x$prefix = xNONE"; then
 dprefix=$ac_default_prefix
else
 dprefix=$prefix
fi

# Old way of installing data into a version dependant dir
#gedatopdir=$dprefix/share/$PACKAGE-$VERSION

gedatopdir=$dprefix/share/$PACKAGE
expandgedadatadir=`echo $gedatopdir`

# new way without version
gedadatadir=$datadir/$PACKAGE

AC_DEFINE_UNQUOTED(GEDADATADIR, "$gedatopdir")
AC_DEFINE_UNQUOTED(VERSION, "$VERSION")


# Do individual library files
  
GEDA_DECLARE_SYMLIB(4000)
GEDA_DECLARE_SYMLIB(national)
GEDA_DECLARE_SYMLIB(local)
GEDA_DECLARE_SYMLIB(io)
GEDA_DECLARE_SYMLIB(analog)
GEDA_DECLARE_SYMLIB(maxim)
GEDA_DECLARE_SYMLIB(verilog)
GEDA_DECLARE_SYMLIB(spice)
GEDA_DECLARE_SYMLIB(connector)
GEDA_DECLARE_SYMLIB(altera)
GEDA_DECLARE_SYMLIB(linear)
GEDA_DECLARE_SYMLIB(switch)
GEDA_DECLARE_SYMLIB(titleblock)
GEDA_DECLARE_SYMLIB(tube)
GEDA_DECLARE_SYMLIB(radio)
GEDA_DECLARE_SYMLIB(micro)
GEDA_DECLARE_SYMLIB(memory)
GEDA_DECLARE_SYMLIB(74)
GEDA_DECLARE_SYMLIB(bus)
GEDA_DECLARE_SYMLIB(supervisor)
GEDA_DECLARE_SYMLIB(lattice)
GEDA_DECLARE_SYMLIB(misc)
GEDA_DECLARE_SYMLIB(xilinx)
GEDA_DECLARE_SYMLIB(dec)
GEDA_DECLARE_SYMLIB(rf)
GEDA_DECLARE_SYMLIB(pla)
GEDA_DECLARE_SYMLIB(ecl)
GEDA_DECLARE_SYMLIB(foot)
GEDA_DECLARE_SYMLIB(IEC417)
GEDA_DECLARE_SYMLIB(font)
GEDA_DECLARE_SYMLIB(idt)

symdir=$gedatopdir/sym
sourcedir=$gedatopdir/source

HOME=`echo $HOME`

# old way of installing data into a version dependant directory
#gedadatadir=$datadir/$PACKAGE-$VERSION
# new way without version
gedadatadir=$datadir/$PACKAGE

if eval "test x$opt_rcdir = x"; then

	if eval "test x$prefix = xNONE"; then
		rclocation=$expandgedadatadir
	else
		rclocation=`eval echo $gedadatadir`
	fi

	# this needs to be expanded (NO ${prefix}) since it's used in the code
	AC_DEFINE_UNQUOTED(GEDARCDIR, "$rclocation")
	expandgedarcdir=$rclocation

	# this is used in the makefiles so it can have a ${prefix} in it
	gedarcdir=$gedadatadir
else

	# path WAS specified with --with-rcdir
	gedarcdir=$opt_rcdir
	expandgedarcdir=$opt_rcdir
	AC_DEFINE_UNQUOTED(GEDARCDIR, "$opt_rcdir")

fi


AC_DEFINE_UNQUOTED(GEDADATADIR, "$gedatopdir")
AC_DEFINE_UNQUOTED(VERSION, "$GEDA_VERSION")

AC_SUBST(gedadatadir)
AC_SUBST(gedarcdir)
AC_SUBST(expandgedadatadir)

AC_SUBST(datalocal)
AC_SUBST(dataanalog)
AC_SUBST(datamaxim)
AC_SUBST(dataverilog)
AC_SUBST(dataspice)
AC_SUBST(dataconnector)
AC_SUBST(dataaltera)
AC_SUBST(datalinear)
AC_SUBST(dataio)
AC_SUBST(dataswitch)
AC_SUBST(datatitleblock)
AC_SUBST(data4000)
AC_SUBST(datanational)
AC_SUBST(datatube)
AC_SUBST(dataradio)
AC_SUBST(datamemory)
AC_SUBST(datamicro)
AC_SUBST(datamisc)
AC_SUBST(data74)
AC_SUBST(databus)
AC_SUBST(datasupervisor)
AC_SUBST(datalattice)
AC_SUBST(dataxilinx)
AC_SUBST(datadec)
AC_SUBST(datapla)
AC_SUBST(dataecl)
AC_SUBST(datarf)
AC_SUBST(datafoot)
AC_SUBST(dataIEC417)
AC_SUBST(datafont)
AC_SUBST(dataidt)

AC_SUBST(symdir)
AC_SUBST(sourcedir)

AC_SUBST(HOME)
AC_SUBST(VERSION)

AC_OUTPUT([ 
        Makefile 
	4000/Makefile
	74/Makefile 
	bus/Makefile 
	supervisor/Makefile 
	lattice/Makefile 
	xilinx/Makefile 
	dec/Makefile 
	pla/Makefile 
	ecl/Makefile 
	rf/Makefile 
	IEC417/Makefile 
	altera/Makefile 
	analog/Makefile 
	connector/Makefile 
	font/Makefile 
	foot/Makefile 
	idt/Makefile 
	io/Makefile 
	linear/Makefile 
	local/Makefile
        maxim/Makefile 
	memory/Makefile 
	micro/Makefile 
	misc/Makefile 
	radio/Makefile 
	switch/Makefile 
	titleblock/Makefile 
	tube/Makefile 
	verilog/Makefile
	spice/Makefile
	national/Makefile
	system-commonrc
        gesym-config ], [chmod +x gesym-config]) 

