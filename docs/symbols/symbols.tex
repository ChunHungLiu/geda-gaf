% gEDA - GPL Electronic Design Automation
% symbols.tex - Symbol Creation Document
% Copyright (C) 2002 Ales V. Hvezda
%
% This program is free software; you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation; either version 2 of the License, or
% (at your option) any later version.
%
% This program is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with this program; if not, write to the Free Software
% Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

\documentclass{article}
\usepackage{epsfig}

\setlength{\parindent}{0pt}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}

\title{gEDA/gaf Symbol Creation Document}
\author{Ales V. Hvezda, ahvezda@geda.seul.org\\
	\\
	This document is released under GFDL\\ 
	(http://www.gnu.org/copyleft/fdl.html)}
\date{September 14th, 2002}

\begin{document}

\maketitle
\newpage

\tableofcontents
\newpage


\section{Overview}

This document describes the creation of component symbols, including style
conventions, and hints/tips and things to look out for when drawing symbols
for the gEDA/gaf system.

\section{Component symbol creation}

Component symbols (from here on known as "symbols") are drawn
using gschem just like drawing a schematic sheet.  Here are the steps in
a symbol in the gEDA/gaf system:

\begin{enumerate}
\item Draw the symbol (see the style guide below for some conventions).
\item Translate the symbol to the origin using Edit/Symbol Translate...
\begin{itemize}
	\item Zoom in at least one step.
	\item Make sure the snap is ON (this is critical).
	\item Make sure grid snap size is set to 100 (this is critical).
	\item Select "Symbol Translate..." or the press equivalent hotkey.
	\item Enter 0 into the entry field and press OK.
\end{itemize}
Translating the symbol to the origin is a required step.  To translate
a symbol elsewhere, enter a offset (in mils) which is a even multiple
of 100.  Make sure all pins are snapped to a 100 mil grid point.
\item Save the symbol using Save or SaveAs...  Here are some symbol naming 
conventions:
\begin{itemize}
	\item Symbols are named: symbolname-\#.sym
	\item Symbols end with a .sym extension.
	\item Symbols have a -\# where \# is a number.  Typically \# is
              1 but if there are multiple symbols for a device then
              this number simply increments.
	\item Symbol names are typically lowercase but letters which
              are part of a part number are uppercase.
	\item The above case rule can be broken if the filename
              looks incorrect or wrong.
\end{itemize}
\item Place the symbol in one of the directories specified by the
      component-library keyword in the system-commonrc file.  Once this is
      done, the symbol should be visible immediately and can be selected
      and placed with the "Add/Select Component..." menu item.

\end{enumerate}

\newpage

\section{Requirements}

This section describes the various requirements which must be met in order
to create a valid symbol which will display and netlist in the gEDA/gaf
system.  Most of the requirements center around having certain attributes
attached or inside the symbol.  

Running {\tt gsymcheck} will check that all of these requirements are met.
{\tt gsymcheck} will output fatal errors which are quite serious and must
be corrected.  {\tt gsymcheck} will also output warnings on things which
should be fixed but are not fatal.  

For more information on the attributes presented here, please see the
Master Attribute Document.

\begin{itemize}
\item {\bf device}=DEVICENAME should be placed somewhere in the symbol
      and made invisible.  {\bf device}= is the device name and
      is required.  Typically the devicename is in all caps (capital
      letters).  This attribute should not be used as a label.  Use a
      separate text object for the label.  If the object is a graphic
      then {\bf device}= should be set to none ({\bf device}=none).
      It is no longer required to attach this attribute anything; just
      having it exist as {\bf device}=DEVICENAME is good enough.

\item {\bf graphical}=1 should exist somewhere in a symbol which is purely
      graphical (such as a title block or decon symbol).  Symbols which
      have this attribute have no electrical or circuit significance.
      Don't forget to set {\bf device}=none.

\item {\bf description}=text should exist somewhere in the symbol.  This 
      attribute provides an one line description of the symbol.

\item All pins should have a pair of attributes attached to them:  
      {\bf pinseq}=\# and {\bf pinnumber}=\#.  The first attribute, 
      {\bf pinseq}=\# is just a sequence number and increments sequentially
      starting at 1.  The second attribute {\bf pinnumber}=\# is the number
      of the pin.  When a symbol is netlisted, the pin numbers are output
      in order of pin sequence.  The pin number can be alphanumeric (i.e. like
      E or C).

\item All pins should also have {\bf pinlabel}=value attached to them.
      This attribute is the name or label of the pin (vs the pin number).
      This attribute is also used when a symbol is used in a hierarchical
      schematic.  Please make this attribute green (instead of the
      default attribute yellow).

\item All pins should also have {\bf pintype}=value attached to them.
      This attribute describes the kind of a pin.  Possible values are:
      in, out, io, oc, oe, pas, tp, tri, clk, pwr.  Please see the Master
      Attribute Document for more info.

\item If a component has multiple slots in a package (such as
      a 7400 (NAND) which has 4 NANDs per package) then you need a
      {\bf numslots}=\# attribute.  The \# is the number of
      slots the device has.  numslots= should be exist somewhere in
      the symbol and made invisible.  Additional slot related required
      attributes are described below.

\item If a component has multiple slots in a physical package then you
      also need to include a {\bf slotdef}=\#:\#,\#,\#...
      for every slot.  The first \# corresponds to the slot number.
      If a device has 4 slots then there should be {\bf slotdef}=1:...,
      {\bf slotdef}=2:..., {\bf slotdef}=3:..., and {\bf slotdef}=4:...,
      attributes existing somewhere in the symbol and made invisible.
      The subsequent \# have a one-to-one correspondence to {\bf pinseq}=\#
      attributes and specify what corresponding {\bf pinnumber}=\#
      should be when that slot is set.  See The attached 7400-1.sym as
      an example of how this should all work.

\item It is recommended that all symbols which have slots have a {\bf
      slot}=1 attribute inside the symbol.

\item {\bf footprint}=PACKAGENAME should exist somewhere in the symbol
      which might be used with the PCB netlister.  PACKAGENAME is the
      PCB footprint or package type like DIP14 or DIP40.  Please see
      the PCB documentation and gnetlist/docs/README.pcb for more info
      on this attribute.

\item You should put a {\bf refdes}=U? attribute inside the symbol.
      Make only the value visible and it will be promoted (attached to
      the outside of the symbol (so it can be edited) when the symbol
      is placed in a schematic.

\item The label= attribute should not be attached anywhere in
      the symbol.  It is obsolete.  

\item The name= attribute should not be attached anywhere in the symbol.

\item The netname= attribute should not be attached anywhere in the
      symbol.  It is only used in schematics.

\end{itemize}

\section{Style}

This section describes the style in which is used in the standard gEDA/gaf 
symbol library.

\subsection{Text}

\begin{itemize}
\item All Text labels should all be 10 pt in size.
\item Text (labels not attributes) should be color number 9 (text | green).
\end{itemize}

\subsection{Attributes}
\begin{itemize}
\item Pin numbers (which are attributes) should all be 8 pt in size.
\item Attached attributes should be yellow.  The color is set
      automatically to yellow if the text item is attached.
\item The only exception to this is pinlabel= attributes, those should be
      color number 9 (text | green).  If every text item within a symbol is
      yellow, the symbol looks too yellow.
\item Attributes can be attached to some part of the symbol.
      Toplevel attributes (like the device= or net= attributes) used to
      be required to be attached to something to be attributes, but now
      they just have to exist in the symbol file as name=value.
\item Expanding a bit on the last sentence, as long as the text item
      has the format name=value, it is considered an attribute.
      Attributes inside a symbol do not have to be attached to anything.
      In order to see hidden attributes in gschem select Edit/Show/Hide Inv
      Text.


\end{itemize}

\subsection{Graphics}

\begin{itemize}
\item Lines, boxes, arcs, and any other graphics should be color number 3 
      (graphic | green).
\item Polarity bubbles should be color number 6 (logic bubble | cyan) 
\end{itemize}

\subsection{Pins}

\begin{itemize}
\item Pins should all be 300 mils (3 grid spaces) long.
\item Pins should be color number 1 (pins | white).
\item Leave 400 mils (4 grid spaces) between (vertically) pins, unless
      you are drawing a special symbol, then just try to make it look
      good.
\item Pin number attributes should be 50 mils above (or below; which
      ever makes the most sense) the pin which they are attached to.
\item Input pins belong on the left and output pins belong on the right of 
      the symbol.
\item Please do not mix inputs and outputs on the same side of the symbol,
      unless absolutely necessary. 
\item You can have pins on the top or bottom of a symbol.

\end{itemize}

\subsection{Electrical}

\begin{itemize}
\item Do not draw power and ground pins.  That information will be
      conveyed using attributes (see the netattrib document).
\item The above rule can be broken if necessary, but keep in mind most of
      the standard library does not have power pins showing.
\item Keep in mind, symbols are supposed to be symbolic, they do not represent
      the physical package that the device comes in.  
\item There is some disagreement on above, so this is okay too: Arrange
      the pins on a symbol logically so that they promote an uncluttered
      schematic.  Note that this is frequently not the same pin
      arrangement as the physical device.
\end{itemize}

\section{Hints and Tips}

This section describes some hints and tips which will make your symbol
creation experience easier.

\begin{itemize}

\item Avoid drawing things off of the grid.  If you do, you cannot move
      the object(s) using the move command (if the grid is on) since the
      object will be snapped to the grid. [This was an old bug, which I
      think has been fixed, but avoid doing this anyway].  Use the symbol
      translate command instead (or move the object with grid snap off)

\item If you need a finer grid then use Options/Snap Grid Spacing...
      to set a finer grid snap spacing.  Just remember to set this back
      to 100 once you are ready to translate the symbol to the origin.

\item If you want to translate a symbol from the origin to elsewhere,
      then use the "Symbol translate" command and enter a non zero number.
      Make sure this number is a multiple of 100 (ie 1000, or 1100).

\item Pins {\bf MUST} be snapped on the 100 spaced grid (at least the end
      which will have nets connected to it).

\item Pins {\bf MUST} be snapped on the 100 spaced grid (at least
      the end which will have nets connected to it).  Yes this is line
      a duplicate.  I can't stress this point enough.

\item Remember that pins are special objects; if you want to add
      a pin, make sure it is a pin and not a line or net.  Use the
      Add/Pin command to place a pin.

\item Don't include nets or buses inside symbols.  That is not supported
      and doesn't make much sense anyway.
\end{itemize}

\section{Example}

This section provides a simple example which tries to follow all of the above
rules.  This symbol is of a 7400 (NAND gate).

\begin{verbatim}

v 20020825
L 300 200 300 800 3 0 0 0 -1 -1
T 300 0 9 8 1 0 0 0
7400
L 300 800 700 800 3 0 0 0 -1 -1
T 500 900 5 10 0 0 0 0
device=7400
T 500 1100 5 10 0 0 0 0
slot=1
T 500 1300 5 10 0 0 0 0
numslots=4
T 500 1500 5 10 0 0 0 0
slotdef=1:1,2,3
T 500 1700 5 10 0 0 0 0
slotdef=2:4,5,6
T 500 1900 5 10 0 0 0 0
slotdef=3:9,10,8
T 500 2100 5 10 0 0 0 0
slotdef=4:12,13,11
L 300 200 700 200 3 0 0 0 -1 -1
A 700 500 300 270 180 3 0 0 0 -1 -1
V 1050 500 50 6 0 0 0 -1 -1 0 -1 -1 -1 -1 -1
P 1100 500 1300 500 1
{
T 1100 550 5 8 1 1 0 0
pinnumber=3
T 1100 450 5 8 0 1 0 2
pinseq=3
T 950 500 9 8 0 1 0 6
pinlabel=Y
T 950 500 5 8 0 1 0 8
pintype=out
}
P 300 300 0 300 1
{
T 200 350 5 8 1 1 0 6
pinnumber=2
T 200 250 5 8 0 1 0 8
pinseq=2
T 350 300 9 8 0 1 0 0
pinlabel=B
T 350 300 5 8 0 1 0 2
pintype=in
}
P 300 700 0 700 1
{
T 200 750 5 8 1 1 0 6
pinnumber=1
T 200 650 5 8 0 1 0 8
pinseq=1
T 350 700 9 8 0 1 0 0
pinlabel=A
T 350 700 5 8 0 1 0 2
pintype=in
}
T 300 900 8 10 1 1 0 0
refdes=U?
T 500 2250 5 10 0 0 0 0
footprint=DIP14
T 500 2450 5 10 0 0 0 0
description=4 NAND gates with 2 inputs
T 500 2650 5 10 0 0 0 0
documentation=http://www-s.ti.com/sc/ds/sn74ls00.pdf
T 500 2850 5 10 0 0 0 0
net=Vcc:14
T 500 3050 5 10 0 0 0 0
net=GND:7
\end{verbatim}

This example produces the following (using gschem): 
\vspace{.125 in}

\begin{center}
\epsfbox{7400a.eps}
\end{center}

This is the same symbol with all the hidden text visible (via Edit/Show/Hide Inv Text):

\begin{center}
\epsfbox{7400b.eps}
\end{center}

\newpage
\section{Document Revision History}

\begin{table}[h]
\begin{tabular}{|l|l|} \hline
September 14th, 2002 & Created symbol.tex from symbols.html \\ \hline
October 31st, 2002 & Fixed bad example symbol \\ \hline

\end{tabular}
\end{table}

\end{document}

